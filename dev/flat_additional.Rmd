---
title: "flat_additional.Rmd empty"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r development, include=FALSE}
library(testthat)
library(shiny)
```

```{r development-1}
pkgload::load_all()
```

# Create icon

```{r function-my_fun}
#' create_icon
#'
#' @param href url to follow when click
#' @param src img to use as icon
#'
#' @importFrom glue glue
#' @importFrom shiny HTML
#'
#' @noRd
create_icon <- function(href, src) {
  htmlTemplate(
    filename = app_sys("app", "www", "templates", "thinkr", "icon.html"),
    href = href,
    src = src
  )
}
```

```{r examples-my_fun}
create_icon("plop.fr", "www/icons/linkedin.png")
```

```{r tests-my_fun}
test_that("create_icon works", {
  code <- create_icon("plop.fr", "www/icons/linkedin.png")
  expect_true(inherits(code, "shiny.tag.list"))
  expect_equal(
    as.character(code),
    "<td>\n  <div>\n    <a href=plop.fr dir=\"ltr\" target=\"_blank\">\n      <img\n        src=www/icons/linkedin.png\n        alt=\"\"\n        width=\"28\"\n        height=\"28\"\n        border=\"0\"\n        style=\"display: block\"\n      />\n    </a>\n  </div>\n</td>\n<td width=\"5\"></td>\n"
  )
})
```


```{r development-inflate, eval=FALSE}
# Run but keep eval=FALSE to avoid infinite loop
# Execute in the console directly
fusen::inflate(
  flat_file = "dev/flat_additional.Rmd",
  vignette_name = "Go further",
  open_vignette = FALSE,
  check = FALSE
)
unlink(here::here("vignettes", "go-further.Rmd"))
devtools::check()
```

